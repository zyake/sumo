# SUMO - A tiny JDBC mapper library

A tiny JDBC mapper library that alleviates the burden of JDBC complexity.

## Concepts

* Throw away XML, Annotation, dynamic proxy, byte code generation
** As simple as possible!
** Eliminate all of unpredictable behaviors.
* Typed query
** You can define a SQL query as a typed one.
** Typed queries are resolved at compile time, not runtime.
* Automatic generation of simple queries
** Simple CRUD queries can be generated automatically.
** The queries are generated by database metadata, not annotations.
* Lambda enabled
** Fully make use of lambda expression.

## How to use

1. Setup the DataSource.

``` java
    Expressions.setDataSource(dataSource);
```

2.  Define entities and queries.

``` java

    // An entity.
    public static class Hoge {

        private int id;

        private String user_name;

        public int getId() {
            return id;
        }

        public void setId(int id) {
            this.id = id;
        }

        public String getUser_name() {
            return user_name;
        }

        public void setUser_name(String user_name) {
            this.user_name = user_name;
        }
    }

    // A query object.
    public enum HogeQueries implements Query {
        SELECT_ALL(Queries.selectAll("HOGE", Mappers.as(Hoge.class))),
        INSERT_HOGE(Queries.insertOne("HOGE")),
        SELECT_ONE_HOGE(Queries.selectOne("HOGE", Mappers.as(Hoge.class))),
        UPDATE_HOGE(Queries.updateOne("HOGE")),
        DELETE_HOGE(Queries.deleteOne("HOGE"));

        private final QueryExpression expression;

        HogeQueries(QueryExpression expression) {
            this.expression = expression;
        }

        @Override
        public QueryExpression expression() {
            return expression;
        }
    }
```

3. Build a SQL object and execute a query.

``` java
      SQL<HogeQueries> sql = new DefaultSQL(HogeQueries.class, datasource.getConnection());

      // INSERT one
      Hoge hoge = new Hoge();
      hoge.setUser_name("test");
      hoge.setId(1);
      sql.update(HogeQueries.INSERT_HOGE, Setups.fieldOf(hoge));

      // SELECT all
      List<Hoge> hoges = sql.query(HogeQueries.SELECT_ALL);

      // UPDATE one
      hoge.setUser_name("CHANGED!");
      sql.update(HogeQueries.UPDATE_HOGE, Setups.fieldOf(hoge));

      // DELETE one
      sql.update(HogeQueries.DELETE_HOGE, Setups.fieldOf(hoge));
```
